(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{370:function(t,a,e){"use strict";e.r(a);var s=e(0),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"signals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signals"}},[t._v("#")]),t._v(" Signals")]),t._v(" "),a("p",[a("Term",{attrs:{term:"signal",show:"Signals"}}),t._v(" provide a mechanism to send data directly to a running "),a("Term",{attrs:{term:"workflow"}}),t._v(". Previously, you had\ntwo options for passing data to the "),a("Term",{attrs:{term:"workflow"}}),t._v(" implementation:")],1),t._v(" "),a("ul",[a("li",[t._v("Via start parameters")]),t._v(" "),a("li",[t._v("As return values from "),a("Term",{attrs:{term:"activity",show:"activities"}})],1)]),t._v(" "),a("p",[t._v("With start parameters, we could only pass in values before "),a("Term",{attrs:{term:"workflow_execution"}}),t._v(" began.")],1),t._v(" "),a("p",[t._v("Return values from "),a("Term",{attrs:{term:"activity",show:"activities"}}),t._v(" allowed us to pass information to a running "),a("Term",{attrs:{term:"workflow"}}),t._v(", but this\napproach comes with its own complications. One major drawback is reliance on polling. This means\nthat the data needs to be stored in a third-party location until it's ready to be picked up by\nthe "),a("Term",{attrs:{term:"activity"}}),t._v(". Further, the lifecycle of this "),a("Term",{attrs:{term:"activity"}}),t._v(" requires management, and the "),a("Term",{attrs:{term:"activity"}}),t._v("\nrequires manual restart if it fails before acquiring the data.")],1),t._v(" "),a("p",[a("Term",{attrs:{term:"signal",show:"Signals"}}),t._v(", on the other hand, provide a fully asynchronous and durable mechanism for providing data to\na running "),a("Term",{attrs:{term:"workflow"}}),t._v(". When a "),a("Term",{attrs:{term:"signal"}}),t._v(" is received for a running "),a("Term",{attrs:{term:"workflow"}}),t._v(", Cadence persists the "),a("Term",{attrs:{term:"event"}}),t._v("\nand the payload in the "),a("Term",{attrs:{term:"workflow"}}),t._v(" history. The "),a("Term",{attrs:{term:"workflow"}}),t._v(" can then process the "),a("Term",{attrs:{term:"signal"}}),t._v(" at any time\nafterwards without the risk of losing the information. The "),a("Term",{attrs:{term:"workflow"}}),t._v(" also has the option to stop\nexecution by blocking on a "),a("Term",{attrs:{term:"signal"}}),t._v(" channel.")],1),t._v(" "),a("h2",{attrs:{id:"implement-signal-handler-in-workflow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#implement-signal-handler-in-workflow"}},[t._v("#")]),t._v(" Implement Signal Handler in Workflow")]),t._v(" "),a("p",[t._v("See the below example from "),a("a",{attrs:{href:"https://github.com/uber/cadence-java-samples/blob/master/src/main/java/com/uber/cadence/samples/hello/HelloSignal.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("sample"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HelloWorld")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@WorkflowMethod")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SignalMethod")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateGreeting")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HelloWorldImpl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HelloWorld")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" greeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bye"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" greeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" oldGreeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Workflow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Objects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldGreeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" greeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateGreeting")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("greeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("The "),a("Term",{attrs:{term:"workflow"}}),t._v(" interface now has a new method annotated with @SignalMethod. It is a callback method that is invoked\nevery time a new "),a("Term",{attrs:{term:"signal"}}),t._v(' of "HelloWorld'),a("Term",{attrs:{term:""}}),t._v('updateGreeting" is delivered to a '),a("Term",{attrs:{term:"workflow"}}),t._v(". The "),a("Term",{attrs:{term:"workflow"}}),t._v(" interface can have only\none @WorkflowMethod which is a "),a("em",[t._v("main")]),t._v(" function of the "),a("Term",{attrs:{term:"workflow"}}),t._v(" and as many "),a("Term",{attrs:{term:"signal"}}),t._v(" methods as needed.")],1),t._v(" "),a("p",[t._v("The updated "),a("Term",{attrs:{term:"workflow"}}),t._v(" implementation demonstrates a few important Cadence concepts. The first is that "),a("Term",{attrs:{term:"workflow"}}),t._v(" is stateful and can\nhave fields of any complex type. Another is that the "),a("code",[t._v("Workflow.await")]),t._v(" function that blocks until the function it receives as a parameter evaluates to true. The condition is going to be evaluated only on "),a("Term",{attrs:{term:"workflow"}}),t._v(" state changes, so it is not a busy wait in traditional sense.")],1),t._v(" "),a("h2",{attrs:{id:"signal-from-command-line"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signal-from-command-line"}},[t._v("#")]),t._v(" Signal From Command Line")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cadence: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow start  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloSignal"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--tasklist")]),t._v(" HelloWorldTaskList "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_type")]),t._v(" HelloWorld::sayHello "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--execution_timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"World'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"\nStarted Workflow Id: HelloSignal, run Id: 6fa204cb-f478-469a-9432-78060b83b6cd\n')])])]),a("p",[t._v("Program output:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:56.120 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("Let's send a "),a("Term",{attrs:{term:"signal"}}),t._v(" using "),a("Term",{attrs:{term:"CLI",show:""}})],1),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cadence: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow signal "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloSignal"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloWorld::updateGreeting"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"Hi'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"\nSignal workflow succeeded.\n')])])]),a("p",[t._v("Program output:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:56.120 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":54:57.901 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": Hi World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("Try sending the same "),a("Term",{attrs:{term:"signal"}}),t._v(" with the same input again. Note that the output doesn't change. This happens because the await condition\ndoesn't unblock when it sees the same value. But a new greeting unblocks it:")],1),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cadence: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow signal "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloSignal"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloWorld::updateGreeting"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"Welcome'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"\nSignal workflow succeeded.\n')])])]),a("p",[t._v("Program output:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:56.120 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": Hello World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":54:57.901 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": Hi World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":56:24.400 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(": Welcome World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("Now shut down the "),a("Term",{attrs:{term:"worker"}}),t._v(" and send the same "),a("Term",{attrs:{term:"signal"}}),t._v(" again:")],1),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cadence: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow signal "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloSignal"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HelloWorld::updateGreeting"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"Welcome'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v('"\nSignal workflow succeeded.\n')])])]),a("p",[t._v("Note that sending "),a("Term",{attrs:{term:"signal",show:"signals"}}),t._v(" as well as starting "),a("Term",{attrs:{term:"workflow",show:"workflows"}}),t._v(" does not need a "),a("Term",{attrs:{term:"worker"}}),t._v(" running. The requests are queued inside the Cadence service.")],1),t._v(" "),a("p",[t._v("Now bring the "),a("Term",{attrs:{term:"worker"}}),t._v(" back. Note that it doesn't log anything besides the standard startup messages.\nThis occurs because it ignores the queued "),a("Term",{attrs:{term:"signal"}}),t._v(" that contains the same input as the current value of greeting.\nNote that the restart of the "),a("Term",{attrs:{term:"worker"}}),t._v(" didn't affect the "),a("Term",{attrs:{term:"workflow_execution"}}),t._v(". It is still blocked on the same line of code as before the failure.\nThis is the most important feature of Cadence. The "),a("Term",{attrs:{term:"workflow"}}),t._v(" code doesn't need to deal with "),a("Term",{attrs:{term:"worker"}}),t._v(" failures at all. Its state is fully recovered to its current state that includes all the local variables and threads.")],1),t._v(" "),a("p",[t._v("Let's look at the line where the "),a("Term",{attrs:{term:"workflow"}}),t._v(" is blocked:")],1),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow stack "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workflow_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello2"')]),t._v("\nQuery result:\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"workflow-root: (BLOCKED on await)\ncom.uber.cadence.internal.sync.SyncDecisionContext.await(SyncDecisionContext.java:546)\ncom.uber.cadence.internal.sync.WorkflowInternal.await(WorkflowInternal.java:243)\ncom.uber.cadence.workflow.Workflow.await(Workflow.java:611)\ncom.uber.cadence.samples.hello.GettingStarted'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$HelloWorldImpl")]),t._v('.sayHello(GettingStarted.java:32)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)"')]),t._v("\n")])])]),a("p",[t._v("Yes, indeed the "),a("Term",{attrs:{term:"workflow"}}),t._v(" is blocked on await. This feature works for any open "),a("Term",{attrs:{term:"workflow"}}),t._v(", greatly simplifying troubleshooting in production.\nLet's complete the "),a("Term",{attrs:{term:"workflow"}}),t._v(" by sending a "),a("Term",{attrs:{term:"signal"}}),t._v(' with a "Bye" greeting:')],1),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":58:22.962 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow-root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" INFO  c.u.c.samples.hello.GettingStarted - "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(": Bye World"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("Note that the value of the count variable was not lost during the restart.")]),t._v(" "),a("p",[t._v("Also note that while a single "),a("Term",{attrs:{term:"worker"}}),t._v(" instance is used for this\nwalkthrough, any real production deployment has multiple "),a("Term",{attrs:{term:"worker"}}),t._v(" instances running. So any "),a("Term",{attrs:{term:"worker"}}),t._v(" failure or restart does not delay any\n"),a("Term",{attrs:{term:"workflow_execution"}}),t._v(" because it is just migrated to any other available "),a("Term",{attrs:{term:"worker"}}),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"signalwithstart-from-command-line"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signalwithstart-from-command-line"}},[t._v("#")]),t._v(" SignalWithStart From Command Line")]),t._v(" "),a("p",[t._v("You may not know if a "),a("Term",{attrs:{term:"workflow"}}),t._v(" is running and can accept a "),a("Term",{attrs:{term:"signal"}}),t._v(".\nThe signalWithStart feature allows you to send a "),a("Term",{attrs:{term:"signal"}}),t._v(" to the current "),a("Term",{attrs:{term:"workflow"}}),t._v(" instance if one exists or to create a new\nrun and then send the "),a("Term",{attrs:{term:"signal"}}),t._v(". "),a("code",[t._v("SignalWithStartWorkflow")]),t._v(" therefore doesn't take a "),a("Term",{attrs:{term:"run_ID"}}),t._v(" as a\nparameter.")],1),t._v(" "),a("p",[t._v("Learn more from the "),a("code",[t._v("--help")]),t._v(" manual:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" ubercadence/cli:master "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--do")]),t._v(" test-domain workflow signalwithstart "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-h")]),t._v("\nNAME:\n   cadence workflow signalwithstart - signal the current "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v(" workflow "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" exists, or attempt to start a new run based on IDResuePolicy and signals it\n\nUSAGE:\n   cadence workflow signalwithstart "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("command options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),a("h2",{attrs:{id:"signal-from-user-application-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signal-from-user-application-code"}},[t._v("#")]),t._v(" Signal from user/application code")]),t._v(" "),a("p",[t._v("You may want to signal workflows without running the command line.")]),t._v(" "),a("p",[t._v("The\n"),a("a",{attrs:{href:"https://www.javadoc.io/doc/com.uber.cadence/cadence-client/latest/com/uber/cadence/client/WorkflowClient.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WorkflowClient"),a("OutboundLink")],1),t._v(" API allows you to send signal (or SignalWithStartWorkflow) from outside of the workflow\nto send a "),a("Term",{attrs:{term:"signal"}}),t._v(" to the current "),a("Term",{attrs:{term:"workflow"}}),t._v(".")],1),t._v(" "),a("p",[t._v("Note that when using "),a("code",[t._v("newWorkflowStub")]),t._v(" to signal a workflow, you MUST NOT passing WorkflowOptions.")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://www.javadoc.io/static/com.uber.cadence/cadence-client/2.7.9-alpha/com/uber/cadence/client/WorkflowClient.html#newWorkflowStub-java.lang.Class-com.uber.cadence.client.WorkflowOptions-",target:"_blank",rel:"noopener noreferrer"}},[t._v("WorkflowStub"),a("OutboundLink")],1),t._v(" with WorkflowOptions is only for starting workflows.")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://www.javadoc.io/static/com.uber.cadence/cadence-client/2.7.9-alpha/com/uber/cadence/client/WorkflowClient.html#newWorkflowStub-java.lang.Class-java.lang.String-",target:"_blank",rel:"noopener noreferrer"}},[t._v("WorkflowStub"),a("OutboundLink")],1),t._v(" without WorkflowOptions is for signal or "),a("a",{attrs:{href:"/docs/java-client/queries"}},[t._v("query")])])])}),[],!1,null,null,null);a.default=r.exports}}]);