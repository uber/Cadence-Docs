"use strict";(self.webpackChunkcadence=self.webpackChunkcadence||[]).push([[3890],{4591:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"go-client/activity-async-completion","title":"Async activity completion","description":"There are certain scenarios when completing an upon completion of its function is not possible","source":"@site/docs/05-go-client/12-activity-async-completion.md","sourceDirName":"05-go-client","slug":"/go-client/activity-async-completion","permalink":"/docs/go-client/activity-async-completion","draft":false,"unlisted":false,"editUrl":"https://github.com/cadence-workflow/Cadence-Docs/tree/master/docs/05-go-client/12-activity-async-completion.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"layout":"default","title":"Async activity completion","permalink":"/docs/go-client/activity-async-completion"},"sidebar":"docsSidebar","previous":{"title":"Queries","permalink":"/docs/go-client/queries"},"next":{"title":"Testing","permalink":"/docs/go-client/workflow-testing"}}');var c=n(4848),o=n(8453);const s={layout:"default",title:"Async activity completion",permalink:"/docs/go-client/activity-async-completion"},a="Asynchronous activity completion",l={},r=[];function d(e){const t={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.header,{children:(0,c.jsx)(t.h1,{id:"asynchronous-activity-completion",children:"Asynchronous activity completion"})}),"\n",(0,c.jsx)(t.p,{children:"There are certain scenarios when completing an activity upon completion of its function is not possible\nor desirable. For example, you might have an application that requires user input in order to complete\nthe activity. You could implement the activity with a polling mechanism, but a simpler and less\nresource-intensive implementation is to asynchronously complete a Cadence activity."}),"\n",(0,c.jsx)(t.p,{children:"There two parts to implementing an asynchronously completed activity:"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsx)(t.li,{children:"The activity provides the information necessary for completion from an external system and notifies\nthe Cadence service that it is waiting for that outside callback."}),"\n",(0,c.jsx)(t.li,{children:"The external service calls the Cadence service to complete the activity."}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:"The following example demonstrates the first part:"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-go",children:'// Retrieve the activity information needed to asynchronously complete the activity.\nactivityInfo := cadence.GetActivityInfo(ctx)\ntaskToken := activityInfo.TaskToken\n\n// Send the taskToken to the external service that will complete the activity.\n...\n\n// Return from the activity a function indicating that Cadence should wait for an async completion\n// message.\nreturn "", activity.ErrResultPending\n'})}),"\n",(0,c.jsx)(t.p,{children:"The following code demonstrates how to complete the activity successfully:"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-go",children:"// Instantiate a Cadence service client.\n// The same client can be used to complete or fail any number of activities.\ncadence.Client client = cadence.NewClient(...)\n\n// Complete the activity.\nclient.CompleteActivity(taskToken, result, nil)\n"})}),"\n",(0,c.jsx)(t.p,{children:"To fail the activity, you would do the following:"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-go",children:"// Fail the activity.\nclient.CompleteActivity(taskToken, nil, err)\n"})}),"\n",(0,c.jsxs)(t.p,{children:["Following are the parameters of the ",(0,c.jsx)(t.code,{children:"CompleteActivity"})," function:"]}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.code,{children:"taskToken"}),": The value of the binary ",(0,c.jsx)(t.code,{children:"TaskToken"})," field of the ",(0,c.jsx)(t.code,{children:"ActivityInfo"})," struct retrieved inside\nthe activity."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.code,{children:"result"}),": The return value to record for the activity. The type of this value must match the type\nof the return value declared by the activity function."]}),"\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.code,{children:"err"}),": The error code to return if the activity terminates with an error."]}),"\n"]}),"\n",(0,c.jsxs)(t.p,{children:["If ",(0,c.jsx)(t.code,{children:"error"})," is not null, the value of the ",(0,c.jsx)(t.code,{children:"result"})," field is ignored."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var i=n(6540);const c={},o=i.createContext(c);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);