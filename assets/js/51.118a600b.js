(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{355:function(e,a,t){"use strict";t.r(a);var s=t(0),r=Object(s.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"cross-dc-replication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cross-dc-replication"}},[e._v("#")]),e._v(" Cross-DC replication")]),e._v(" "),a("p",[e._v("The Cadence Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" feature provides clients with the capability to continue their "),a("Term",{attrs:{term:"workflow_execution"}}),e._v(" from another\ncluster in the event of a datacenter failover. Although you can configure a Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" to be replicated to any number of\nclusters, it is only considered active in a single cluster.")],1),e._v(" "),a("h2",{attrs:{id:"global-domains-architecture"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#global-domains-architecture"}},[e._v("#")]),e._v(" Global Domains Architecture")]),e._v(" "),a("p",[e._v("Cadence has introduced a new top level entity, Global "),a("Term",{attrs:{term:"domain",show:"Domains"}}),e._v(", which provides support for replication of "),a("Term",{attrs:{term:"workflow"}}),e._v("\nexecution across clusters. A global domain can be configured with more than one clusters, but can only be "),a("code",[e._v("active")]),e._v(" in one of the clusters at any point of time.\nWe call it "),a("code",[e._v("passive")]),e._v(" or "),a("code",[e._v("standby")]),e._v(" when not active in other clusters.")],1),e._v(" "),a("p",[e._v("The number of standby clusters can be zero, if a global domain only configured to one cluster. This is preferred/recommended.")]),e._v(" "),a("p",[e._v("Any workflow of a global domain can only make make progress in its "),a("code",[e._v("active")]),e._v(" cluster. And the workflow progress is replicated to other "),a("code",[e._v("standby")]),e._v(" clusters. For example,\nstarting workflow by calling "),a("code",[e._v("StartWorkflow")]),e._v(", or starting activity(by "),a("code",[e._v("PollForActivityTask")]),e._v(" API), can only be processed in its active cluster. After active cluster made progress,\nstandby clusters (if any) will poll the history from active to replicate the workflow states.")]),e._v(" "),a("p",[e._v("However, standby clusters can also receive the requests, e.g. for starting workflows or starting activities. They know which cluster the domain is active at.\nSo the requests can be routed to the active clusters. This is called "),a("code",[e._v("api-forwarding")]),e._v(" in Cadence. "),a("code",[e._v("api-forwarding")]),e._v(" makes it possible to have no downtime during failover.\nThere are two "),a("code",[e._v("api-forwarding")]),e._v(" policy: "),a("code",[e._v("selected-api-forwarding")]),e._v(" and "),a("code",[e._v("all-domain-api-forwarding")]),e._v(" policy.")]),e._v(" "),a("p",[e._v("When using "),a("code",[e._v("selected-api-forwarding")]),e._v(", applications need to run different set of activity & workflow "),a("Term",{attrs:{term:"worker",show:"workers"}}),e._v(" polling on every cluster.\nCadence will only dispatch tasks on the current active cluster; "),a("Term",{attrs:{term:"worker",show:"workers"}}),e._v(" on the standby cluster will sit idle\nuntil the Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" is failed over. This is recommended if XDC is being used in multiple clusters running in very remote data centers(regions), which forwarding is expensive to do.")],1),e._v(" "),a("p",[e._v("When using "),a("code",[e._v("all-domain-api-forwarding")]),e._v(", applications only need to run activity & workflow "),a("Term",{attrs:{term:"worker",show:"workers"}}),e._v(" polling on one cluster. This makes it easier for the application setup. This is recommended\nwhen clusters are all in local or nearby datacenters.  See more details in "),a("a",{attrs:{href:"https://github.com/uber/cadence/discussions/4530",target:"_blank",rel:"noopener noreferrer"}},[e._v("discussion"),a("OutboundLink")],1),e._v(".")],1),e._v(" "),a("h3",{attrs:{id:"conflict-resolution"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conflict-resolution"}},[e._v("#")]),e._v(" Conflict Resolution")]),e._v(" "),a("p",[e._v("Unlike local "),a("Term",{attrs:{term:"domain",show:"domains"}}),e._v(" which provide at-most-once semantics for "),a("Term",{attrs:{term:"activity"}}),e._v(" execution, Global "),a("Term",{attrs:{term:"domain",show:"Domains"}}),e._v(" can only support at-least-once\nsemantics. Cadence global domain relies on asynchronous replication of "),a("Term",{attrs:{term:"event",show:"events"}}),e._v(" across clusters, so in the event of a failover\nit is possible that "),a("Term",{attrs:{term:"activity"}}),e._v(" gets dispatched again on the new active cluster due to a replication "),a("Term",{attrs:{term:"task"}}),e._v(" lag. This also\nmeans that whenever "),a("Term",{attrs:{term:"workflow_execution"}}),e._v(" is updated after a failover by the new cluster, any previous replication "),a("Term",{attrs:{term:"task",show:"tasks"}}),e._v("\nfor that execution cannot be applied. This results in loss of some progress made by the "),a("Term",{attrs:{term:"workflow_execution"}}),e._v(" in the\nprevious active cluster. During such conflict resolution, Cadence re-injects any external "),a("Term",{attrs:{term:"event",show:"events"}}),e._v(" like "),a("Term",{attrs:{term:"signal",show:"Signals"}}),e._v(" to the\nnew history before discarding replication "),a("Term",{attrs:{term:"task",show:"tasks"}}),e._v(". Even though some progress could rollback during failovers, Cadence\nprovides the guarantee that "),a("Term",{attrs:{term:"workflow",show:"workflows"}}),e._v(" wonâ€™t get stuck and will continue to make forward progress.")],1),e._v(" "),a("h2",{attrs:{id:"global-domain-concepts-configuration-and-operation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#global-domain-concepts-configuration-and-operation"}},[e._v("#")]),e._v(" Global Domain Concepts, Configuration and Operation")]),e._v(" "),a("h3",{attrs:{id:"concepts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#concepts"}},[e._v("#")]),e._v(" Concepts")]),e._v(" "),a("h4",{attrs:{id:"isglobal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isglobal"}},[e._v("#")]),e._v(" IsGlobal")]),e._v(" "),a("p",[e._v("This config is used to distinguish "),a("Term",{attrs:{term:"domain",show:"domains"}}),e._v(" local to the cluster from the global "),a("Term",{attrs:{term:"domain"}}),e._v(". It controls the creation of\nreplication "),a("Term",{attrs:{term:"task",show:"tasks"}}),e._v(" on updates allowing the state to be replicated across clusters. This is a read-only setting that can\nonly be set when the "),a("Term",{attrs:{term:"domain"}}),e._v(" is provisioned.")],1),e._v(" "),a("h4",{attrs:{id:"clusters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clusters"}},[e._v("#")]),e._v(" Clusters")]),e._v(" "),a("p",[e._v("A list of clusters where the "),a("Term",{attrs:{term:"domain"}}),e._v(" can fail over to, including the current active cluster.\nThis is also a read-only setting that can only be set when the "),a("Term",{attrs:{term:"domain"}}),e._v(" is provisioned. A re-replication feature on the\nroadmap will allow updating this config to add/remove clusters in the future.")],1),e._v(" "),a("h4",{attrs:{id:"active-cluster-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#active-cluster-name"}},[e._v("#")]),e._v(" Active Cluster Name")]),e._v(" "),a("p",[e._v("Name of the current active cluster for the Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(". This config is updated each time the Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" is failed over to\nanother cluster.")],1),e._v(" "),a("h4",{attrs:{id:"failover-version"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#failover-version"}},[e._v("#")]),e._v(" Failover Version")]),e._v(" "),a("p",[e._v("Unique failover version which also represents the current active cluster for Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(". Cadence allows failover to\nbe triggered from any cluster, so failover version is designed in a way to not allow conflicts if failover is mistakenly\ntriggered simultaneously on two clusters.")],1),e._v(" "),a("h3",{attrs:{id:"operate-by-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#operate-by-cli"}},[e._v("#")]),e._v(" Operate by CLI")]),e._v(" "),a("p",[e._v("The Cadence "),a("Term",{attrs:{term:"CLI"}}),e._v(" can also be used to "),a("Term",{attrs:{term:"query"}}),e._v(" the "),a("Term",{attrs:{term:"domain"}}),e._v(" config or perform failovers. Here are some useful commands.")],1),e._v(" "),a("h4",{attrs:{id:"describe-global-domain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#describe-global-domain"}},[e._v("#")]),e._v(" Describe Global Domain")]),e._v(" "),a("p",[e._v("The following command can be used to describe Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" metadata:")],1),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ cadence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--do")]),e._v(" cadence-canary-xdc d desc\nName: cadence-canary-xdc\nDescription: cadence canary cross "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("dc")]),e._v(" testing domain\nOwnerEmail: cadence-dev@cadenceworkflow.io\nDomainData:\nStatus: REGISTERED\nRetentionInDays: "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v("\nEmitMetrics: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\nActiveClusterName: dc1\nClusters: dc1, dc2\n")])])]),a("h4",{attrs:{id:"failover-global-domain-using-domain-update-command-being-deprecated-in-favor-of-managed-graceful-failover"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#failover-global-domain-using-domain-update-command-being-deprecated-in-favor-of-managed-graceful-failover"}},[e._v("#")]),e._v(" Failover Global Domain using domain update command(being deprecated in favor of managed graceful failover)")]),e._v(" "),a("p",[e._v("The following command can be used to failover Global "),a("Term",{attrs:{term:"domain",show:"Domain"}}),e._v(" "),a("em",[e._v("my-domain-global")]),e._v(" to the "),a("em",[e._v("dc2")]),e._v(" cluster:")],1),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ cadence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--do")]),e._v(" my-domain-global d up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--ac")]),e._v(" dc2\n")])])]),a("h4",{attrs:{id:"failover-global-domain-using-managed-graceful-failover"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#failover-global-domain-using-managed-graceful-failover"}},[e._v("#")]),e._v(" Failover Global Domain using Managed Graceful Failover")]),e._v(" "),a("p",[e._v("First of all, update the domain to enable this feature for the domain")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ cadence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--do")]),e._v(" test-global-domain-0 d update "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--domain_data")]),e._v(" IsManagedByCadence:true\n$ cadence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--do")]),e._v(" test-global-domain-1 d update "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--domain_data")]),e._v(" IsManagedByCadence:true\n$ cadence "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--do")]),e._v(" test-global-domain-2 d update "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--domain_data")]),e._v(" IsManagedByCadence:true\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("p",[e._v("Then you can start failover the those global domains using managed failover:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("cadence admin cluster failover start "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--source_cluster")]),e._v(" dc1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--target_cluster")]),e._v(" dc2\n")])])]),a("p",[e._v("This will failover all the domains with "),a("code",[e._v("IsManagedByCadence:true")]),e._v(" from dc1 to dc2.")]),e._v(" "),a("p",[e._v("You can provide more detailed options when using the command, and also watch the progress of the failover.\nFeel free to explore the "),a("code",[e._v("cadence admin cluster failover")]),e._v(" tab.")]),e._v(" "),a("h2",{attrs:{id:"running-locally"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-locally"}},[e._v("#")]),e._v(" Running Locally")]),e._v(" "),a("p",[e._v("The best way is to use Cadence "),a("a",{attrs:{href:"https://github.com/uber/cadence/tree/master/docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker-compose"),a("OutboundLink")],1),e._v(":\n"),a("code",[e._v("docker-compose -f docker-compose-multiclusters.yml up")])]),e._v(" "),a("h2",{attrs:{id:"running-in-production"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-in-production"}},[e._v("#")]),e._v(" Running in Production")]),e._v(" "),a("p",[e._v("Enable global domain feature needs to be enabled in "),a("RouterLink",{attrs:{to:"/docs/operation-guide/setup/#static-configs"}},[e._v("static config")]),e._v(".")],1),e._v(" "),a("p",[e._v('Here we use clusterDCA and clusterDCB as an example. We pick clusterDCA as the primary(used to called "master") cluster.\nThe only difference of being a primary cluster is that it is responsible for domain registration. Primary can be changed later but it needs to be the same across all clusters.')]),e._v(" "),a("p",[e._v("The ClusterMeta config of clusterDCA should be")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("dcRedirectionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("policy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"selected-apis-forwarding"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterMetadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enableGlobalDomain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("failoverVersionIncrement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("masterClusterName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"clusterDCA"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("currentClusterName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"clusterDCA"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterInformation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterDCA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("initialFailoverVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cadence-frontend"')]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<>:<>"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterDCB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("initialFailoverVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cadence-frontend"')]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<>:<>"')]),e._v("\n")])])]),a("p",[e._v("And ClusterMeta config of clusterDCB should be")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("dcRedirectionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("policy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"selected-apis-forwarding"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterMetadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enableGlobalDomain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("failoverVersionIncrement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("masterClusterName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"clusterDCA"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("currentClusterName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"clusterDCB"')]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterInformation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterDCA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("initialFailoverVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cadence-frontend"')]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<>:<>"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("clusterDCB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("initialFailoverVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cadence-frontend"')]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("rpcAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<>:<>"')]),e._v("\n")])])]),a("p",[e._v("After the configuration is deployed:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Register a global domain\n"),a("code",[e._v("cadence --do <domain_name> domain register --global_domain true --clusters clusterDCA clusterDCB --active_cluster clusterDCA")])])]),e._v(" "),a("li",[a("p",[e._v("Run some workflow and failover domain from one to another\n"),a("code",[e._v("cadence --do <domain_name> domain update --active_cluster clusterDCB")])])])]),e._v(" "),a("p",[e._v("Then the domain should be failed over to clusterDCB. Now worklfows are read-only in clusterDCA. So your workers polling tasks from clusterDCA will become idle.")]),e._v(" "),a("p",[e._v("Note 1: that even though clusterDCA is standy/read-only for this domain, it can be active for another domain. So being active/standy is per domain basis not per clusters. In other words, for example if you use XDC in case of DC failure of clusterDCA, you need to failover all domains from clusterDCA to clusterDCB.")]),e._v(" "),a("p",[e._v("Note 2: even though a domain is standy/read-only in a cluster, say clusterDCA, sending write requests(startWF, signalWF, etc) could still work because there is a forwarding component in the Frontend service. It will try to re-route the requests to an active cluster for the domain.")])])}),[],!1,null,null,null);a.default=r.exports}}]);