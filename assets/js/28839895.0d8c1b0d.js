"use strict";(self.webpackChunkcadence=self.webpackChunkcadence||[]).push([[9171],{649:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>w,frontMatter:()=>l,metadata:()=>n,toc:()=>s});const n=JSON.parse('{"id":"get-started/golang-hello-world","title":"Golang hello world","description":"This section provides step-by-step instructions on how to write and run a HelloWorld workflow in Cadence with Golang. You will learn two critical building blocks of Cadence: activities and workflows. First, you will write an activity function that prints a \\"Hello World!\\" message in the log. Then, you will write a workflow function that executes this activity.","source":"@site/docs/01-get-started/03-golang-hello-world.md","sourceDirName":"01-get-started","slug":"/get-started/golang-hello-world","permalink":"/Cadence-Docs/docs/get-started/golang-hello-world","draft":false,"unlisted":false,"editUrl":"https://github.com/cadence-workflow/Cadence-Docs/tree/master/docs/01-get-started/03-golang-hello-world.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"layout":"default","title":"Golang hello world","permalink":"/docs/get-started/golang-hello-world"},"sidebar":"docsSidebar","previous":{"title":"Java hello world","permalink":"/Cadence-Docs/docs/get-started/java-hello-world"},"next":{"title":"Video Tutorials","permalink":"/Cadence-Docs/docs/get-started/video-tutorials"}}');var r=o(4848),i=o(8453);const l={layout:"default",title:"Golang hello world",permalink:"/docs/get-started/golang-hello-world"},a="Golang Hello World",c={},s=[{value:"Prerequisite",id:"prerequisite",level:2},{value:"Step 1. Implement A Cadence Worker Service",id:"step-1-implement-a-cadence-worker-service",level:2},{value:"Step 2. Write a simple Cadence hello world activity and workflow",id:"step-2-write-a-simple-cadence-hello-world-activity-and-workflow",level:2},{value:"Step 3. Run the workflow with Cadence CLI",id:"step-3-run-the-workflow-with-cadence-cli",level:2},{value:"(Optional) Step 4. Monitor Cadence workflow with Cadence web UI",id:"optional-step-4-monitor-cadence-workflow-with-cadence-web-ui",level:2},{value:"What is Next",id:"what-is-next",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"golang-hello-world",children:"Golang Hello World"})}),"\n",(0,r.jsx)(t.p,{children:'This section provides step-by-step instructions on how to write and run a HelloWorld workflow in Cadence with Golang. You will learn two critical building blocks of Cadence: activities and workflows. First, you will write an activity function that prints a "Hello World!" message in the log. Then, you will write a workflow function that executes this activity.'}),"\n",(0,r.jsx)(t.h2,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,r.jsx)(t.p,{children:"To successfully run this hello world sample, follow this checklist of setting up Cadence environment"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Your worker is running properly and you have registered the hello world activity and workflow to the worker"}),"\n",(0,r.jsx)(t.li,{children:"Your Cadence server is running (check your background docker container process)"}),"\n",(0,r.jsx)(t.li,{children:"You have successfully registered a domain for this workflow"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["You must finish part 2 and 3 by following the ",(0,r.jsx)(t.a,{href:"/docs/get-started/server-installation",children:"first section"})," to proceed the next steps.\nWe are using domain called ",(0,r.jsx)(t.code,{children:"test-domain"})," for this tutorial project."]}),"\n",(0,r.jsx)(t.h2,{id:"step-1-implement-a-cadence-worker-service",children:"Step 1. Implement A Cadence Worker Service"}),"\n",(0,r.jsxs)(t.p,{children:["Create a new ",(0,r.jsx)(t.code,{children:"main.go"})," file in your local directory and paste the basic worker service layout."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n    "net/http"\n    "go.uber.org/cadence/.gen/go/cadence/workflowserviceclient"\n    "go.uber.org/cadence/compatibility"\n    "go.uber.org/cadence/worker"\n\n    apiv1 "github.com/cadence-workflow/cadence-idl/go/proto/api/v1"\n    "github.com/uber-go/tally"\n    "go.uber.org/zap"\n    "go.uber.org/zap/zapcore"\n    "go.uber.org/yarpc"\n    "go.uber.org/yarpc/transport/grpc"\n)\n\nvar HostPort = "127.0.0.1:7833"\nvar Domain = "test-domain"\nvar TaskListName = "test-worker"\nvar ClientName = "test-worker"\nvar CadenceService = "cadence-frontend"\n\nfunc main() {\n    startWorker(buildLogger(), buildCadenceClient())\n    err := http.ListenAndServe(":8080", nil)\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc buildLogger() *zap.Logger {\n    config := zap.NewDevelopmentConfig()\n    config.Level.SetLevel(zapcore.InfoLevel)\n\n    var err error\n    logger, err := config.Build()\n    if err != nil {\n        panic("Failed to setup logger")\n    }\n\n    return logger\n}\n\nfunc buildCadenceClient() workflowserviceclient.Interface {\n    dispatcher := yarpc.NewDispatcher(yarpc.Config{\n\t\tName: ClientName,\n\t\tOutbounds: yarpc.Outbounds{\n\t\t  CadenceService: {Unary: grpc.NewTransport().NewSingleOutbound(HostPort)},\n\t\t},\n\t  })\n\t  if err := dispatcher.Start(); err != nil {\n\t\tpanic("Failed to start dispatcher")\n\t  }\n\n\t  clientConfig := dispatcher.ClientConfig(CadenceService)\n\n\t  return compatibility.NewThrift2ProtoAdapter(\n\t\tapiv1.NewDomainAPIYARPCClient(clientConfig),\n\t\tapiv1.NewWorkflowAPIYARPCClient(clientConfig),\n\t\tapiv1.NewWorkerAPIYARPCClient(clientConfig),\n\t\tapiv1.NewVisibilityAPIYARPCClient(clientConfig),\n\t  )\n}\n\nfunc startWorker(logger *zap.Logger, service workflowserviceclient.Interface) {\n    // TaskListName identifies set of client workflows, activities, and workers.\n    // It could be your group or client or application name.\n    workerOptions := worker.Options{\n        Logger:       logger,\n        MetricsScope: tally.NewTestScope(TaskListName, map[string]string{}),\n    }\n\n    worker := worker.New(\n        service,\n        Domain,\n        TaskListName,\n        workerOptions)\n    err := worker.Start()\n    if err != nil {\n        panic("Failed to start worker")\n    }\n\n    logger.Info("Started Worker.", zap.String("worker", TaskListName))\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"In this worker service, we start a HTTP server and create a new Cadence client running continuously at the background. Then start the server on your local, you may see logs such like"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-log",children:'2023-07-03T11:46:46.266-0700    INFO    internal/internal_worker.go:826 Worker has no workflows registered, so workflow worker will not be started.     {"Domain": "test-domain", "TaskList": "test-worker", "WorkerID": "35987@uber-C02F18EQMD6R@test-worker@90c0260e-ba5c-4652-9f10-c6d1f9e29c1d"}\n2023-07-03T11:46:46.267-0700    INFO    internal/internal_worker.go:834 Started Workflow Worker {"Domain": "test-domain", "TaskList": "test-worker", "WorkerID": "35987@uber-C02F18EQMD6R@test-worker@90c0260e-ba5c-4652-9f10-c6d1f9e29c1d"}\n2023-07-03T11:46:46.267-0700    INFO    internal/internal_worker.go:838 Worker has no activities registered, so activity worker will not be started.    {"Domain": "test-domain", "TaskList": "test-worker", "WorkerID": "35987@uber-C02F18EQMD6R@test-worker@90c0260e-ba5c-4652-9f10-c6d1f9e29c1d"}\n2023-07-03T11:46:46.267-0700    INFO    cadence-worker/main.go:75       Started Worker. {"worker": "test-worker"}\n'})}),"\n",(0,r.jsx)(t.p,{children:"You may see this because there are no activities and workflows registered to the worker. Let's proceed to next steps to write a hello world activity and workflow."}),"\n",(0,r.jsx)(t.h2,{id:"step-2-write-a-simple-cadence-hello-world-activity-and-workflow",children:"Step 2. Write a simple Cadence hello world activity and workflow"}),"\n",(0,r.jsxs)(t.p,{children:["Let's write a hello world activity, which take a single input called ",(0,r.jsx)(t.code,{children:"name"})," and greet us after the workflow is finished."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'func helloWorldWorkflow(ctx workflow.Context, name string) error {\n\tao := workflow.ActivityOptions{\n\t\tScheduleToStartTimeout: time.Minute,\n\t\tStartToCloseTimeout:    time.Minute,\n\t\tHeartbeatTimeout:       time.Second * 20,\n\t}\n\tctx = workflow.WithActivityOptions(ctx, ao)\n\n\tlogger := workflow.GetLogger(ctx)\n\tlogger.Info("helloworld workflow started")\n\tvar helloworldResult string\n\terr := workflow.ExecuteActivity(ctx, helloWorldActivity, name).Get(ctx, &helloworldResult)\n\tif err != nil {\n\t\tlogger.Error("Activity failed.", zap.Error(err))\n\t\treturn err\n\t}\n\n\tlogger.Info("Workflow completed.", zap.String("Result", helloworldResult))\n\n\treturn nil\n}\n\nfunc helloWorldActivity(ctx context.Context, name string) (string, error) {\n\tlogger := activity.GetLogger(ctx)\n\tlogger.Info("helloworld activity started")\n\treturn "Hello " + name + "!", nil\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"Don't forget to register the workflow and activity to the worker."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func init() {\n    workflow.Register(helloWorldWorkflow)\n    activity.Register(helloWorldActivity)\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Import the ",(0,r.jsx)(t.code,{children:"context"})," module if it was not automatically added."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'import (\n    "context"\n)\n'})}),"\n",(0,r.jsx)(t.h2,{id:"step-3-run-the-workflow-with-cadence-cli",children:"Step 3. Run the workflow with Cadence CLI"}),"\n",(0,r.jsx)(t.p,{children:"Restart your worker and run the following command to interact with your workflow."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"cadence --domain test-domain workflow start --et 60 --tl test-worker --workflow_type main.helloWorldWorkflow --input '\"World\"'\n"})}),"\n",(0,r.jsx)(t.p,{children:"You should see logs in your worker terminal like"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-log",children:'2023-07-16T11:30:02.717-0700    INFO    cadence-worker/code.go:104      Workflow completed. {"Domain": "test-domain", "TaskList": "test-worker", "WorkerID": "11294@uber-C02F18EQMD6R@test-worker@5829c68e-ace0-472f-b5f3-6ccfc7903dd5", "WorkflowType": "main.helloWorldWorkflow", "WorkflowID": "8acbda3c-d240-4f27-8388-97c866b8bfb5", "RunID": "4b91341f-056f-4f0b-ab64-83bcc3a53e5a", "Result": "Hello World!"}\n'})}),"\n",(0,r.jsx)(t.p,{children:"Congratulations! You just launched your very first Cadence workflow from scratch"}),"\n",(0,r.jsx)(t.h2,{id:"optional-step-4-monitor-cadence-workflow-with-cadence-web-ui",children:"(Optional) Step 4. Monitor Cadence workflow with Cadence web UI"}),"\n",(0,r.jsx)(t.p,{children:"When you start the Cadence backend server, it also automatically starts a front end portal for your workflow. Open you browser and go to"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"http://localhost:8088",children:"http://localhost:8088"})}),"\n",(0,r.jsxs)(t.p,{children:["You may see a dashboard below\n",(0,r.jsx)(t.img,{alt:"cadence-ui",src:o(2954).A+"",width:"3790",height:"674"})]}),"\n",(0,r.jsxs)(t.p,{children:["Type the domain you used for the tutorial, in this case, we type ",(0,r.jsx)(t.code,{children:"test-domain"})," and hit enter. Then you can see a complete history of the workflows you have triggered associated to this domain.\n",(0,r.jsx)(t.img,{alt:"cadence-ui-detailed",src:o(8255).A+"",width:"3790",height:"764"})]}),"\n",(0,r.jsx)(t.h2,{id:"what-is-next",children:"What is Next"}),"\n",(0,r.jsxs)(t.p,{children:["Now you have completed the tutorials. You can continue to explore the key ",(0,r.jsx)(t.a,{href:"/docs/concepts",children:"concepts"})," in Cadence, and also how to use them with ",(0,r.jsx)(t.a,{href:"/docs/go-client",children:"Go Client"})]}),"\n",(0,r.jsxs)(t.p,{children:["For complete, ready to build samples covering all the key Cadence concepts go to ",(0,r.jsx)(t.a,{href:"https://github.com/cadence-workflow/cadence-samples",children:"Cadence-Samples"})," for more examples."]}),"\n",(0,r.jsxs)(t.p,{children:["You can also review ",(0,r.jsx)(t.a,{href:"https://github.com/cadence-workflow/cadence-go-client/",children:"Cadence-Client"})," and ",(0,r.jsx)(t.a,{href:"https://pkg.go.dev/go.uber.org/cadence",children:"go-docs"})," for more documentation."]})]})}function w(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2954:(e,t,o)=>{o.d(t,{A:()=>n});const n=o.p+"assets/images/cadence_ui-7a1200a6a9f9d11aa28452f0cd539b71.png"},8255:(e,t,o)=>{o.d(t,{A:()=>n});const n=o.p+"assets/images/cadence_ui_detailed-786dba0e7aa1f9048af4f0c1420c3ccf.png"},8453:(e,t,o)=>{o.d(t,{R:()=>l,x:()=>a});var n=o(6540);const r={},i=n.createContext(r);function l(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);